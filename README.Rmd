---
output: github_document
editor_options: 
  chunk_output_type: console
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

# ATTENTION

The base of this package was cloned from the original at [{kaggler}](https://github.com/mkearney/kaggler). I have decided to take the developers work and continue their amazing development! Major props and recognition goes out to the original developer(s) of this package.

I will be updating all documentation and examples for the README and functions for this package.

---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%",
  cache = TRUE
)
library(kaggler)
options(width = 100)
options(tibble.print_min = 5)
options(tibble.print_max = 5)
```
# kaggler <img src="man/figures/logo.png" width="160px" align="right" />

> üèÅ An R client for accessing [Kaggle](https://www.kaggle.com)'s API

<!-- badges: start -->
[![R-CMD-check](https://github.com/KoderKow/kaggler/workflows/R-CMD-check/badge.svg)](https://github.com/KoderKow/kaggler/actions)
<!-- badges: end -->

## Installation

You can install the dev version of **{kaggler}** from [CRAN](https://github.com/mkearney/kaggler) with:

```{r, eval = FALSE}
## install kaggler package from github
devtools::install_packages("koderkow/kaggler")
```

## API authorization

<span>1.</span> Go to [https://www.kaggle.com/](kaggle.com) and sign in

<span>2.</span> Click `Account` or navigate to `https://www.kaggle.com/{username}/account`

<span>3.</span> Scroll down to the `API` section and click `Create New API Token` (which should cause you to download a `kaggle.json` file with your username and API key)

<p style='align:center'><img src='tools/readme/kag.png' /></p>

<span>4.</span> There are a few different ways to store your credentials

  - Save/move the `kaggle.json` file as `~/.kaggle/kaggle.json`
  - Save/move the `kaggle.json` file to your current working directory
  - Enter your `username` and `key` and use the `kgl_auth()` function like in the example below 

```{r, eval = FALSE}
kgl_auth(username = "koderkow", key = "example")
#> Your Kaggle key has been recorded for this session and saved as `KAGGLE_PAT` environment variable for future sessions.
```

## `kgl_competitions_list_.*()`

Browse or search for Kaggle compeitions.

```{r complist}
## look through all competitions (paginated)
comps1 <- kgl_competitions_list()
comps1

## it's paginated, so to see page two:
comps2 <- kgl_competitions_list(page = 2)
comps2

## search by keyword for competitions
imagecomps <- kgl_competitions_list(search = "image")
imagecomps
```

## `kgl_competitions_data_.*()`

You can look up the datalist for a given Kaggle competition using the API. 

```{r}
## data list for a given competition
c1_datalist <- kgl_competitions_data_list(comps1$ref[1])
c1_datalist
```

Downloading single files is possible by supplying the competition ID and the wanted file.

```{r, eval = FALSE}
## download set sets (IF YOU HAVE ACCEPTED COMPETITION RULES)
c1_data <- kgl_competitions_data_download(
  id = comps1$ref[1],
  file_name = c1_datalist$name[1]
  )
#> x You must accept this competition's rules before you'll be able to download files.
```

### Downloading all data for a competition

#### ID input

Methods have been built out to accept multiple forms of `id`.

1. The competition URL
    - `https://www.kaggle.com/c/titanic` and `https://www.kaggle.com/c/titanic/code` will recognize `titanic` as the ID
2. Kaggle's API command
    - Kaggles official API is built in python and they supply a command to download the data on the data tab of a competition. The download functions will take `kaggle competitions download -c titanic`and recognize the ID as `titanic`
3. Explicit ID
    - If the above two cases don't match in the logic then everything else will be considered an ID
    - Example; entering `titanic` directly
  
#### `kgl_competitions_data_download_all()`

This function will download all the competitions data files into a dir called `_kaggle_data` into the main working directory.

```{r}
kgl_data <- kgl_competitions_data_download_all(
  id = "https://www.kaggle.com/c/titanic/"
  )
```

The data is available in the `_kaggle_data` directory.

```{r}
list.files("_kaggle_data")
```

```{r, include = FALSE}
fs::dir_delete("_kaggle_data")
```

The data is also returned in a list and available in the variable you assigned it to, in this example its `kgl_data`.

```{r}
kgl_data$train
kgl_data$test
kgl_data$gender_submission
```

### Future goals for downloads

- Check the download folder to see if any of the files exists. If yes, prompt the user to redownload the ones that exist. If they dont exist, download them
- Easily load/attach all kaggle data with a function, similar to `{targets}`'s `tar_load()`
- Create a "Kaggle Workflow" that will guide the user on setting up their project space
    - Have a family of functions that will set the competitions ID, download the data, and have it ready for the user

## `kgl_datasets_.*()`

Get a list of all of the datasets.

```{r datalist}
## get competitions data list
datasets <- kgl_datasets_list()
datasets
```

## `kgl_competitions_leaderboard_.*()`

View the leaderboard for a given competition.

```{r leaderboard}
## get competitions data list
c1_leaderboard <- kgl_competitions_leaderboard_view(comps1$ref[1])
c1_leaderboard
```


## Note(s)

- The the developers are in no way affiliated with Kaggle.com, and, as such, makes no assurances that there won't be breaking changes to the API at any time
- Although the developers are not affiliated, it's good practice to be informed, so here is the link to Kaggle's terms of service: https://www.kaggle.com/terms

